# コミットメッセージの構造

## 基本構造

コミットメッセージは以下の構造に従ってください：

```
<タイトル行>

<本文>
```

## タイトル行

- 50 文字以内で簡潔に記述
- 現在形で記述（例：「Add」, 「Fix」, 「Update」）
- 文末にピリオドを付けない
- 変更の種類を明確に示す

### タイトル行の例

- `feat: ユーザー登録機能の追加`
- `fix: ログイン時のバグ修正`
- `docs: READMEの更新`
- `style: コードフォーマットの修正`
- `refactor: 認証処理のリファクタリング`

## 本文

- 空行を 1 行入れてから記述
- 72 文字以内で折り返し
- 変更の理由や詳細な説明を記述
- 箇条書きを使用する場合は、ハイフン（-）を使用

### 本文の例

```
feat: ユーザー登録機能の追加

- メールアドレスとパスワードによる登録機能を実装
- バリデーション機能を追加
- 登録完了時のメール送信機能を実装
```

## 注意事項

- タイトル行と本文の間に必ず空行を入れる
- 変更内容が明確に分かるように記述する
- 技術的な詳細は本文に記述する

## 良い例と悪い例

### 良い例

```
feat: ユーザープロフィール編集機能の追加

- プロフィール画像のアップロード機能を実装
- ユーザー名と自己紹介文の編集機能を追加
- バリデーション処理を実装
```

```
fix: パスワードリセット機能のバグ修正

- リセットリンクの有効期限切れ時のエラーメッセージを修正
- パスワード強度チェックのロジックを修正
```

```
refactor: データベースクエリの最適化

- N+1問題を解決するためにEagerローディングを実装
- インデックスの追加によるクエリパフォーマンスの改善
```

### 悪い例

```
update
```

→ 変更内容が不明確

```
fixed bug
```

→ どのバグを修正したのか不明確

```
いろいろ修正した
```

→ 変更内容が具体的でない

```
feat: ユーザー登録機能の追加 バグ修正 パフォーマンス改善 コード整理
```

→ 1 つのコミットに複数の変更が含まれている

```
fix: バグ修正
バグを修正しました
```

→ 本文が具体的な説明になっていない

## プレフィックスの使用方法

### 主要なプレフィックス

- `feat`: 新機能の追加
- `fix`: バグ修正
- `docs`: ドキュメントの変更のみ
- `style`: コードの意味に影響を与えない変更（空白、フォーマット、セミコロンの欠落など）
- `refactor`: バグ修正や機能追加ではないコードの変更
- `perf`: パフォーマンスを改善するコードの変更
- `test`: テストの追加や既存のテストの修正
- `chore`: ビルドプロセスやツールの変更、ライブラリの更新など

### プレフィックスの使用例

```

feat: ユーザー認証機能の追加

```

→ 新しい機能を追加する場合

```

fix: ログイン時のセッション切れ問題を修正

```

→ バグを修正する場合

```

docs: API 仕様書の更新

```

→ ドキュメントのみを変更する場合

```

style: インデントの修正

```

→ コードの動作に影響を与えない変更の場合

```

refactor: ユーザー認証ロジックのリファクタリング

```

→ コードの構造を改善する場合

```

perf: データベースクエリの最適化

```

→ パフォーマンスを改善する場合

```

test: ユーザー登録機能のテストケース追加

```

→ テストを追加・修正する場合

```

chore: 依存パッケージの更新

```

→ ビルドプロセスやツールの変更を行う場合

### プレフィックス使用の注意点

1. プレフィックスは小文字で記述
2. プレフィックスの後にコロン（:）とスペースを入れる
3. 1 つのコミットには 1 つのプレフィックスのみを使用
4. プレフィックスは変更の種類を正確に反映させる

## Issue 番号の参照方法

### 基本的な参照方法

コミットメッセージのタイトル行の末尾に、関連する Issue 番号を記述します。

```
feat: ユーザー認証機能の追加 #123
```

### 複数の Issue を参照する場合

複数の Issue を参照する場合は、カンマで区切って記述します。

```
fix: ログイン機能のバグ修正 #123, #456
```

### Issue をクローズする場合

コミットメッセージに特定のキーワードを含めることで、Issue を自動的にクローズできます。

```
fix: ログイン機能のバグ修正 #123

Closes #123
```

使用可能なキーワード：

- `Closes #123`
- `Fixes #123`
- `Resolves #123`

### 注意事項

1. Issue 番号は必ず`#`記号の後に記述
2. タイトル行の末尾に記述する場合は、Issue 番号の前にスペースを入れる
3. 本文で参照する場合は、適切な位置に記述可能
4. 存在しない Issue 番号は参照しない

## コミットの適切なサイズと内容

### コミットの粒度

1. 機能単位でのコミット

   - 1 つの機能や修正につき 1 つのコミット
   - 関連する変更のみをまとめる
   - 例：ユーザー登録機能の実装、ログイン機能の修正など

2. 変更の範囲

   - 1 つのファイルの変更は 1 つのコミットにまとめる
   - 複数ファイルの変更は、関連性のあるもののみをまとめる
   - 例：認証関連の複数ファイルの修正、UI コンポーネントの一括更新など

3. コミットのサイズ
   - 小さすぎる：1 行の変更だけのコミットは避ける
   - 大きすぎる：複数の機能や修正を 1 つのコミットに含めない
   - 適切なサイズ：1 つの機能や修正に関連する変更のみを含める

### コミットの内容

1. 関連性のある変更のみを含める

   - 機能追加とバグ修正は別のコミットに分ける
   - リファクタリングと機能追加は別のコミットに分ける
   - ドキュメント更新とコード変更は別のコミットに分ける

2. テストと実装
   - テストコードと実装コードは別のコミットに分ける
   - テストが失敗するコミットは避ける
   - テストの追加と実装の修正は別のコミットに分ける

## コミット履歴の確認方法

### 基本的な確認コマンド

1. コミット履歴の表示

   ```bash
   # 最新のコミット履歴を表示
   git log

   # コミット履歴を簡潔に表示
   git log --oneline

   # 特定のファイルの変更履歴を表示
   git log --oneline <ファイル名>
   ```

2. コミットの詳細確認

   ```bash
   # 特定のコミットの詳細を表示
   git show <コミットハッシュ>

   # コミットの差分を表示
   git diff <コミットハッシュ>
   ```

3. ブランチの履歴確認

   ```bash
   # ブランチの履歴をグラフィカルに表示
   git log --graph --oneline --all

   # 特定のブランチの履歴を表示
   git log <ブランチ名>
   ```

### 便利なオプション

1. コミット履歴のフィルタリング

   ```bash
   # 特定の作者のコミットを表示
   git log --author="<作者名>"

   # 特定の日付以降のコミットを表示
   git log --since="<日付>"

   # 特定のファイルの変更を含むコミットを表示
   git log -- <ファイル名>
   ```

2. コミット履歴のフォーマット

   ```bash
   # コミット履歴をカスタムフォーマットで表示
   git log --pretty=format:"%h - %an, %ar : %s"

   # コミット履歴をJSON形式で表示
   git log --pretty=format:'{%n  "commit": "%H",%n  "author": "%an",%n  "date": "%ad",%n  "message": "%s"%n},'
   ```

### 注意事項

1. コミット履歴の確認は定期的に行う
2. チームメンバーのコミット履歴も確認する
3. コミットメッセージの品質を確認する
4. 不適切なコミットは修正を検討する
